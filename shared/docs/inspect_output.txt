Loading archit11/new2...
Dataset keys: dict_keys(['prompt', 'response', 'metadata'])
Sample entry:
{'prompt': "[BUG] update `api_key_expiry_workflow` to validate the expiry before scheduling the task\n\n### Bug Description\r\n\r\nWe have a `process_tracker` which schedules the task to future date, and executes it whenever the time is up. We have a feature to schedule a reminder email to notify the merchants when their api_key is about to expire.\r\nCurrently, when the api_key is created with some expiry set, process tracker schedules the 1st email, 7 days prior to api_key expiry. But just in case merchant sets the expiry to next day, process tracker will schedule the email to past day which won't be executed by process tracker. \r\n\r\n### Expected Behavior\r\n\r\nDuring the api_key expiry if the merchant sets the expiry to next day or any other day before 7 days, we need to perform a validation something like - calculate the schedule_time of 1st email during api_key creation. if it is before the current_time, don't create an entry in process_tracker.\r\n\r\nfile to include the change - \r\nhttps://github.com/juspay/hyperswitch/blob/e913bfc4958da613cd352eca9bc38b23ab7ac38e/crates/router/src/core/api_keys.rs#L193C1-L193C1\r\n\r\n### Steps To Reproduce\r\n\r\n1. Run below commands in 3 diff terminals\r\n    - cargo r --features email (application)\r\n    - SCHEDULER_FLOW=producer cargo r --bin scheduler (producer binary)\r\n    - SCHEDULER_FLOW=consumer cargo r --bin scheduler (consumer binary)\r\n2. Create an api_key with expiry set to next day in postman.\r\n3. Check the process_tracker table in db which will contain the schedule_time field set to past day.\r\n\r\n\r\n### Context For The Bug\r\n\r\nJust to cover the edge case\r\n\r\n\r\n### Have you spent some time to check if this bug has been raised before?\r\n\r\n- [X] I checked and didn't find similar issue\r\n\r\n### Have you read the Contributing Guidelines?\r\n\r\n- [X] I have read the [Contributing Guidelines](https://github.com/juspay/hyperswitch/blob/main/docs/CONTRIBUTING.md)\r\n\r\n### Are you willing to submit a PR?\r\n\r\nNo, but I'm happy to collaborate on a PR with someone else", 'response': '**<think>**\nThis PR fixes a bug in the API key expiry workflow where the scheduler could schedule reminder emails for past dates. The implementation validates the scheduled time before creating entries in the process tracker, ensuring only valid future dates are processed.\n</think>\n\n**crates/router/src/core/api_keys.rs**\n- Modify: `api_key_expiry_workflow()` - validate schedule time before scheduling', 'metadata': '{"original_length": 991, "transformed_length": 403, "reduction_pct": 59.3}'}

Loading archit11/hyperswitch-filenames...
Dataset keys: dict_keys(['repo', 'instance_id', 'problem_statement', 'patch', 'test_patch', 'created_at', 'hints_text', 'base_commit', 'test_instructions', 'filenames'])
Sample entry:
{'repo': 'juspay/hyperswitch', 'instance_id': 'juspay__hyperswitch-9755', 'problem_statement': "Bug: [BUG] Migration runner fails due to Just already present\n\n\n\n### Description:\n\nIn `docker-compose.yml`, the `migration-runner` service fails if we run `docker compose up` more than once, because, the `just` installer doesn't handle the case where just is already installed.\n\n### Solution:\n\nAdd a conditional check to run `just` installer only if `just` is not present already.", 'patch': 'diff --git a/docker-compose.yml b/docker-compose.yml\nindex e16dd74466b..4e2600c8344 100644\n--- a/docker-compose.yml\n+++ b/docker-compose.yml\n@@ -63,7 +63,9 @@ services:\n       bash -c "\n       apt-get update && apt-get install -y curl xz-utils &&\n       curl --proto \'=https\' --tlsv1.2 -LsSf https://github.com/diesel-rs/diesel/releases/latest/download/diesel_cli-installer.sh | bash &&\n-      curl --proto \'=https\' --tlsv1.2 -sSf https://just.systems/install.sh | bash -s -- --to /usr/local/bin &&\n+      if ! command -v just >/dev/null 2>&1; then\n+        curl --proto \'=https\' --tlsv1.2 -sSf https://just.systems/install.sh | bash -s -- --to /usr/local/bin\n+      fi &&\n       export PATH="$${PATH}:$${HOME}/.cargo/bin" &&\n       just migrate"\n     working_dir: /app\n', 'test_patch': '', 'created_at': '2025-10-08T10:15:48Z', 'hints_text': '## Type of Change\r\n<!-- Put an `x` in the boxes that apply -->\r\n\r\n- [x] Bugfix\r\n- [ ] New feature\r\n- [ ] Enhancement\r\n- [ ] Refactoring\r\n- [ ] Dependency updates\r\n- [ ] Documentation\r\n- [ ] CI/CD\r\n\r\n## Description\r\n<!-- Describe your changes in detail -->\r\nThe migration-runner service in the `docker-compose.yml` file fails during a second deployment as `just` installer raises `just already installed` error. This PR fixes that issue issue by adding a conditional statement which calls the just installer only when just command is not available.\r\n\r\n### Additional Changes\r\n\r\n- [ ] This PR modifies the API contract\r\n- [ ] This PR modifies the database schema\r\n- [ ] This PR modifies application configuration/environment variables\r\n\r\n<!--\r\nProvide links to the files with corresponding changes.\r\n\r\nFollowing are the paths where you can find config files:\r\n1. `config`\r\n2. `crates/router/src/configs`\r\n3. `loadtest/config`\r\n-->\r\n\r\n\r\n## Motivation and Context\r\n<!--\r\nWhy is this change required? What problem does it solve?\r\nIf it fixes an open issue, please link to the issue here.\r\n\r\nIf you don\'t have an issue, we\'d recommend starting with one first so the PR\r\ncan focus on the implementation (unless it is an obvious bug or documentation fix\r\nthat will have little conversation).\r\n-->\r\nN/A\r\n\r\n## How did you test it?\r\n<!--\r\nDid you write an integration/unit/API test to verify the code changes?\r\nOr did you test this change manually (provide relevant screenshots)?\r\n-->\r\nRan `docker compose up -d` twice.\r\n<img width="476" height="491" alt="Screenshot 2025-10-08 at 3 44 53\u202fPM" src="https://github.com/user-attachments/assets/c9de99cd-ac3a-4ab9-8c4e-5a1bb8d48d84" />\r\n\r\n\r\n## Checklist\r\n<!-- Put an `x` in the boxes that apply -->\r\n\r\n- [x] I formatted the code `cargo +nightly fmt --all`\r\n- [x] I addressed lints thrown by `cargo clippy`\r\n- [x] I reviewed the submitted code\r\n- [ ] I added unit tests for my changes where possible\r\n', 'base_commit': 'b52aafa8873fc4704bd69014cc457daf32d5523c', 'test_instructions': '\r\nRan `docker compose up -d` twice.\r\n<img width="476" height="491" alt="Screenshot 2025-10-08 at 3 44 53\u202fPM" src="https://github.com/user-attachments/assets/c9de99cd-ac3a-4ab9-8c4e-5a1bb8d48d84" />\r', 'filenames': ['docker-compose.yml']}
